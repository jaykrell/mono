all: test2.exe

clean:
	-rm -f Mono.Ext.dll test2data.cs test2data.dll test1.exe test1data.dll test1data.cs

test: test2.exe
	mono ./test2.exe

Mono.Ext.dll: Mono.Ext.cs
	mcs $? /t:library

gentest2: gentest2.c makefiletest
	gcc gentest2.c -o $@

test2data.cs: gentest2 makefiletest
	./gentest2 > $@

test2data.dll: test2data.cs
	mcs $? /target:library

test2.exe: test2.cs test2data.dll Mono.Ext.dll makefiletest
	mcs test2.cs /r:test2data.dll,Mono.Ext.dll